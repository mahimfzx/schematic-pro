<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Schematic Pro Ultimate</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* =========================================
           CSS VARIABLES (THEMING)
           ========================================= */
        :root {
            /* Dark Theme (Default) */
            --primary: #ebc107;
            --primary-glow: rgba(235, 193, 7, 0.3);
            --bg-body: #0b0c10;
            --surface: #1f2833;
            --surface-hover: #2b3544;
            --text-main: #ffffff;
            --text-sub: #c5c6c7;
            --border: #333;
            --box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            --input-bg: #15181e;
        }

        [data-theme="light"] {
            /* Light Theme */
            --primary: #d4a000;
            --primary-glow: rgba(212, 160, 0, 0.2);
            --bg-body: #f4f6f8;
            --surface: #ffffff;
            --surface-hover: #f0f0f0;
            --text-main: #1a202c;
            --text-sub: #4a5568;
            --border: #e2e8f0;
            --box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            --input-bg: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            transition: background 0.3s, color 0.3s;
            overflow-x: hidden;
            font-size: 16px;
        }

        /* Tech Fonts for Headings */
        h1, h2, .brand-title, .model-name, .chip { font-family: 'Rajdhani', sans-serif; }

        #app-container {
            max-width: 600px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--bg-body);
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* =========================================
           HEADER SECTION
           ========================================= */
        header {
            background: var(--surface);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--primary-glow);
            transition: background 0.3s;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand-title {
            font-size: 26px;
            font-weight: 700;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .theme-toggle {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-main);
            width: 40px; height: 40px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: 0.3s;
        }
        .theme-toggle:hover { background: var(--surface-hover); color: var(--primary); }

        /* Search Bar */
        .search-wrapper { position: relative; width: 100%; }
        
        .search-icon-svg {
            position: absolute;
            left: 15px; top: 50%;
            transform: translateY(-50%);
            width: 18px; height: 18px;
            fill: var(--primary);
        }

        input#searchBox {
            width: 100%;
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 14px 15px 14px 45px;
            border-radius: 10px;
            font-size: 15px;
            transition: 0.3s;
        }

        input#searchBox:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-glow);
        }

        /* Filter Chips */
        .filters {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .filters::-webkit-scrollbar { height: 0; }

        .chip {
            background: var(--bg-body);
            border: 1px solid var(--border);
            color: var(--text-sub);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
            cursor: pointer;
            transition: 0.3s;
        }

        .chip.active {
            background: var(--primary);
            color: #000;
            border-color: var(--primary);
        }

        /* =========================================
           LIST VIEW SECTION
           ========================================= */
        .list-view { 
            padding: 10px 0; 
            flex: 1; /* Pushes footer down */
            min-height: 50vh;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background 0.2s;
            background: var(--bg-body);
        }

        .list-item:active { background: var(--surface-hover); }

        .model-info { display: flex; flex-direction: column; }
        .model-name { font-size: 18px; font-weight: 700; color: var(--text-main); }
        .arrow-svg { width: 20px; height: 20px; fill: var(--primary); }

        /* =========================================
           DETAIL VIEW (OVERLAY)
           ========================================= */
        .detail-view {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg-body);
            z-index: 200;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding-bottom: 50px;
        }

        .detail-view.active { transform: translateX(0); }

        .detail-header {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            background: var(--surface);
            position: sticky;
            top: 0;
            z-index: 210;
            border-bottom: 1px solid var(--border);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .back-btn {
            background: transparent; border: none;
            cursor: pointer; padding-right: 15px;
            display: flex; align-items: center;
        }
        .back-svg { width: 24px; height: 24px; fill: var(--text-main); }

        .detail-title { font-size: 22px; font-weight: 700; color: var(--text-main); }
        .detail-content { padding: 20px; }

        /* Info Boxes */
        .info-box {
            background: var(--surface);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            box-shadow: var(--box-shadow);
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .info-header {
            display: flex; align-items: center; gap: 8px;
            margin-bottom: 12px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 8px;
        }

        .info-icon { width: 18px; height: 18px; fill: var(--primary); }
        
        .info-label {
            font-size: 13px; font-weight: 700;
            color: var(--primary); text-transform: uppercase; letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 16px; color: var(--text-main);
            word-wrap: break-word; line-height: 1.6;
        }

        /* Buttons & Previews */
        .btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 8px;
            padding: 10px 16px; border-radius: 8px;
            font-size: 14px; font-weight: 600;
            text-decoration: none; border: none; cursor: pointer;
            transition: transform 0.2s; width: 100%; margin-top: 10px;
        }
        .btn:active { transform: scale(0.97); }

        .btn-dl { background: #e53e3e; color: white; }
        .btn-view { background: #3182ce; color: white; }
        .btn-icon { width: 16px; height: 16px; fill: white; }

        .preview-area {
            margin-top: 15px; border-radius: 8px;
            overflow: hidden; border: 1px solid var(--border);
            background: #eee; display: none;
            position: relative;
        }
        .preview-area iframe { width: 100%; height: 500px; border: none; }
        .preview-area img { width: 100%; display: block; }

        /* =========================================
           FOOTER SECTION
           ========================================= */
        .footer {
            text-align: center;
            padding: 40px 20px;
            background: var(--surface);
            border-top: 1px solid var(--border);
            margin-top: auto;
        }

        .disclaimer {
            font-size: 12px;
            color: var(--text-sub);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .dev-info {
            background: var(--bg-body);
            display: inline-block;
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid var(--border);
        }

        .dev-info p {
            font-size: 13px; color: var(--text-main); margin-bottom: 2px;
        }
        
        .dev-info a {
            color: var(--primary); font-size: 12px; text-decoration: none; font-weight: 600;
        }

        /* Loader */
        .spinner {
            width: 40px; height: 40px; margin: 50px auto;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%; animation: spin 0.8s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <div id="app-container">
        <header>
            <div class="header-top">
                <div class="brand-title">Schematic<span style="color:var(--text-main)">Pro</span></div>
                <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">
                    <svg class="info-icon" viewBox="0 0 24 24" style="fill:var(--text-main)"><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path></svg>
                </button>
            </div>
            
            <div class="search-wrapper">
                <svg class="search-icon-svg" viewBox="0 0 24 24"><path d="M21.71 20.29L18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42zM11 18a7 7 0 1 1 7-7 7 7 0 0 1-7 7z"/></svg>
                <input type="text" id="searchBox" placeholder="Search any model, cpu, battery...">
            </div>

            <div class="filters">
                <div class="chip active" onclick="sortData('all', this)">All Models</div>
                <div class="chip" onclick="sortData('asc', this)">A-Z Name</div>
                <div class="chip" onclick="sortData('desc', this)">Z-A Name</div>
            </div>
        </header>

        <div id="listView" class="list-view">
            <div class="spinner"></div>
        </div>

        <div class="footer">
            <p class="disclaimer">
                <strong>Disclaimer:</strong> This website and its content are for educational and technical repair purposes only. Use these files responsibly.
            </p>
            <div class="dev-info">
                <p>Developed by <span style="color:var(--primary); font-weight:700;">Mahim Patwary</span></p>
                <a href="mailto:mahimfzx@gmail.com">mahimfzx@gmail.com</a>
            </div>
        </div>
    </div>

    <div id="detailView" class="detail-view">
        <div class="detail-header">
            <button class="back-btn" onclick="closeDetails()">
                <svg class="back-svg" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
            </button>
            <div class="detail-title" id="dtTitle">Details</div>
        </div>
        <div class="detail-content" id="dtContent">
            </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        // আপনার Apps Script লিংক এখানে দিন (Deployment ID যেন ঠিক থাকে)
        const API_URL = 'https://script.google.com/macros/s/AKfycby-Mj4FPLQaCtRBsAQ4vYgFnzZOqZ-E1prVqISq5FIclFqBwC2xsxOzLHD99wf0TGON/exec'; 

        // SVG ICONS LIBRARY
        const ICONS = {
            pdf: '<svg class="info-icon" viewBox="0 0 24 24"><path d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"/></svg>',
            image: '<svg class="info-icon" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>',
            text: '<svg class="info-icon" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>',
            download: '<svg class="btn-icon" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>',
            eye: '<svg class="btn-icon" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>',
            sun: '<svg class="info-icon" viewBox="0 0 24 24" style="fill:var(--text-main)"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.79 1.41-1.41-1.79-1.79-1.41 1.41zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"/></svg>',
            moon: '<svg class="info-icon" viewBox="0 0 24 24" style="fill:var(--text-main)"><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path></svg>'
        };

        let allData = [];
        let currentData = [];

        // 1. THEME LOGIC
        function toggleTheme() {
            const body = document.body;
            const btn = document.getElementById('themeBtn');
            const isLight = body.getAttribute('data-theme') === 'light';
            
            if (isLight) {
                body.removeAttribute('data-theme');
                btn.innerHTML = ICONS.moon;
            } else {
                body.setAttribute('data-theme', 'light');
                btn.innerHTML = ICONS.sun;
            }
        }

        // 2. INITIALIZATION
        async function init() {
            try {
                const res = await fetch(API_URL);
                allData = await res.json();
                currentData = allData;
                renderList(currentData);
            } catch (e) {
                document.getElementById('listView').innerHTML = `<div style="text-align:center;padding:20px;color:red;">Error connecting to database.</div>`;
            }
        }

        // 3. RENDER LIST
        function renderList(data) {
            const container = document.getElementById('listView');
            container.innerHTML = '';
            
            if (data.length === 0) {
                container.innerHTML = `<div style="text-align:center;padding:40px;color:var(--text-sub)">No results found.</div>`;
                return;
            }

            const fragment = document.createDocumentFragment();
            data.forEach(item => {
                const modelName = item['Model Name'] || 'Unknown';
                const div = document.createElement('div');
                div.className = 'list-item';
                div.innerHTML = `
                    <div class="model-info">
                        <span class="model-name">${modelName}</span>
                    </div>
                    <svg class="arrow-svg" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                `;
                div.onclick = () => openDetails(item);
                fragment.appendChild(div);
            });
            container.appendChild(fragment);
        }

        // 4. SEARCH FUNCTIONALITY
        document.getElementById('searchBox').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase().trim();
            currentData = allData.filter(item => {
                return Object.values(item).some(val => 
                    String(val).toLowerCase().includes(term)
                );
            });
            renderList(currentData);
        });

        // 5. SORTING FUNCTIONALITY
        function sortData(type, el) {
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
            el.classList.add('active');

            if(type === 'all') {
                document.getElementById('searchBox').value = '';
                currentData = [...allData];
            } else if (type === 'asc') {
                currentData.sort((a, b) => (a['Model Name'] || '').localeCompare(b['Model Name'] || ''));
            } else if (type === 'desc') {
                currentData.sort((a, b) => (b['Model Name'] || '').localeCompare(a['Model Name'] || ''));
            }
            renderList(currentData);
        }

        // Helper: Extract Drive ID from URL (WITH SAFETY CHECK)
        function getDriveId(url) {
            // FIX: Check if URL is a string first!
            if (!url || typeof url !== 'string') return null;
            
            const match = url.match(/[-\w]{25,}/);
            return match ? match[0] : null;
        }

        // 6. DETAILS PAGE LOGIC
        function openDetails(item) {
            const title = document.getElementById('dtTitle');
            const content = document.getElementById('dtContent');
            
            title.innerText = item['Model Name'];
            content.innerHTML = '';

            for (const key in item) {
                if (!item[key] || key === 'Model Name') continue;

                const value = item[key];
                // FIX: Convert value to string to avoid crashes with numbers
                const strValue = String(value || ""); 

                const cleanLabel = key.replace(/_pdf|_img/g, '').replace(/_/g, ' ');
                const driveId = getDriveId(strValue); // Use safe string value
                
                let boxHTML = '';

                // PDF Section
                if (key.endsWith('_pdf')) {
                    let pdfSrc = `https://docs.google.com/viewer?url=${encodeURIComponent(strValue)}&embedded=true`;
                    if (driveId) {
                        pdfSrc = `https://drive.google.com/file/d/${driveId}/preview`;
                    }

                    boxHTML = `
                        <div class="info-box">
                            <div class="info-header">${ICONS.pdf} <span class="info-label">${cleanLabel}</span></div>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                                <a href="${strValue}" target="_blank" class="btn btn-dl">${ICONS.download} Download</a>
                                <button onclick="togglePreview('p-${key}')" class="btn btn-view">${ICONS.eye} View PDF</button>
                            </div>
                            <div id="p-${key}" class="preview-area">
                                <iframe loading="lazy" src="${pdfSrc}" allow="autoplay"></iframe>
                            </div>
                        </div>`;
                }
                // Image Section
                else if (key.endsWith('_img')) {
                    let imgSrc = strValue;
                    if (driveId) {
                        imgSrc = `https://drive.google.com/uc?export=view&id=${driveId}`;
                    }

                    boxHTML = `
                        <div class="info-box">
                            <div class="info-header">${ICONS.image} <span class="info-label">${cleanLabel}</span></div>
                            <div style="display:grid; grid-template-columns:1fr; gap:10px;">
                                <button onclick="togglePreview('i-${key}')" class="btn btn-view">${ICONS.eye} View Image</button>
                            </div>
                            <div id="i-${key}" class="preview-area">
                                <img loading="lazy" src="${imgSrc}" alt="Preview">
                            </div>
                        </div>`;
                }
                // Text Section
                else {
                    boxHTML = `
                        <div class="info-box">
                            <div class="info-header">${ICONS.text} <span class="info-label">${cleanLabel}</span></div>
                            <div class="info-value">${value}</div>
                        </div>`;
                }
                content.innerHTML += boxHTML;
            }

            document.getElementById('detailView').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeDetails() {
            document.getElementById('detailView').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function togglePreview(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === 'block') ? 'none' : 'block';
        }

        init();
    </script>
</body>
</html>
